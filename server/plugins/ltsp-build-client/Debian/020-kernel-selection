case "$MODE" in
    commandline)
        add_option "kernel-packages" "`eval_gettext "set the list of kernel packages to install."`" "advanced" "true"
        ;;
    configure)
        if [ -n "$option_kernel_packages_value" ]; then
            KERNEL_PACKAGES="$(echo $option_kernel_packages_value | tr ',' ' ')"
        fi
        ;;
    before-install)
        if [ -n "$KERNEL_PACKAGES" ]; then
            LATE_PACKAGES="$LATE_PACKAGES $KERNEL_PACKAGES"
        else
           # select a kernel
           KERNEL_BASE="linux-image"
           case $ARCH in
               i386)
                  KERNEL_ARCH="486"
                  ;;
               sparc) 
                   KERNEL_ARCH="$(uname -m)"
                   ;;
               alpha)
                   KERNEL_ARCH="alpha-generic"
                   ;;
               *)
                   KERNEL_ARCH="$ARCH"
                   ;;
           esac
           test -n "$KERNEL_VERSION" && KERNEL_BASE="$KERNEL_BASE-$KERNEL_VERSION"
           LATE_PACKAGES="$LATE_PACKAGES $KERNEL_BASE-$KERNEL_ARCH"
        fi
        ;;
esac
