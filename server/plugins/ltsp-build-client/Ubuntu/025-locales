case $MODE in
    commandline)
        add_option "locale" "`eval_gettext "Set the default locale"`" "advanced" "true"
        ;;
    configure)
        if [ -n "$option_locale_value" ]; then
            LOCALE="$option_locale_value"
        fi
        ;;
    install)
        if [ -z "$LOCALE" ]; then
            LOCALE="$LANG"
        fi

        if [ "$LOCALE" = "C" ]; then
            chroot $ROOT locale-gen en_GB
        else
            chroot $ROOT locale-gen $LOCALE
        fi

        if [ "$LOCALE" = "C" ] && [ -f /etc/environment ]; then
            cp /etc/environment $ROOT/etc/
        else
            echo "LANG=$LOCALE" >> $ROOT/etc/environment
        fi
        export LANG="$LOCALE"

        if [ -f /etc/default/console-setup ]; then
            cp /etc/default/console-setup $ROOT/etc/default/console-setup
        fi
        ;;
esac
